{
  "code": "export default class Scratch extends fgui.GComponent {\r\n    constructor() {\r\n        super();\r\n        this.preX = 0;\r\n        this.preY = 0;\r\n        this.firstBrush = true;\r\n        this._circleDiameter = 40;\r\n        this._percentCover = 0.5;\r\n        this._pointCount = 100;\r\n        this._row = 10;\r\n        this._col = 10;\r\n        this._pointsArr = [];\r\n    }\r\n    constructFromXML(xml) {\r\n        super.constructFromXML(xml);\r\n        this.on(Laya.Event.MOUSE_DOWN, this, this.onMouseDown);\r\n        this.on(Laya.Event.MOUSE_UP, this, this.onMouseUp);\r\n        this._panel = this.getChild(\"panel\").asCom;\r\n        this._maskPanel = this.getChild(\"mask\").asCom;\r\n    }\r\n    onMouseDown(evt) {\r\n        if (this._maskPanel) {\r\n            if (this.firstBrush) {\r\n                this._maskPanel.displayObject.graphics.clear();\r\n                this.firstBrush = false;\r\n                this.createPoints(this._maskPanel.width, this._maskPanel.height);\r\n            }\r\n            this.preX = evt.target.mouseX;\r\n            this.preY = evt.target.mouseY;\r\n            this._maskPanel.displayObject.graphics.drawCircle(this.preX, this.preY, this._circleDiameter, \"#a5ff00\");\r\n            this.on(Laya.Event.MOUSE_MOVE, this, this.onMouseMove);\r\n        }\r\n        if (this._panel) {\r\n            this._panel.visible = false;\r\n        }\r\n    }\r\n    onMouseMove(evt) {\r\n        var curX = evt.target.mouseX;\r\n        var curY = evt.target.mouseY;\r\n        if (this._maskPanel) {\r\n            this._maskPanel.displayObject.graphics.drawCircle(curX, curY, this._circleDiameter, \"#a5ff00\");\r\n            this.preX = curX;\r\n            this.preY = curY;\r\n        }\r\n        var point = { x: curX, y: curY };\r\n        this.pointsHitTest(this._pointsArr, point);\r\n        console.log(`${this._pointsArr.length}/${this._pointCount}`);\r\n        if (this._pointsArr.length / this._pointCount <= this._percentCover) {\r\n            this._maskPanel.displayObject.graphics.drawRect(0, 0, this._maskPanel.width, this._maskPanel.height, \"#000\");\r\n        }\r\n    }\r\n    onMouseUp(evt) {\r\n        this.off(Laya.Event.MOUSE_MOVE, this, this.onMouseMove);\r\n    }\r\n    createPoints(width, height) {\r\n        let widthSpan = Math.trunc(width / this._row), heightSpan = Math.trunc(height / this._col);\r\n        for (let i = 0; i < this._row; i++) {\r\n            for (let j = 0; j < this._col; j++) {\r\n                let point = new Laya.Point(widthSpan * i, heightSpan * j);\r\n                this._pointsArr.push(point);\r\n            }\r\n        }\r\n    }\r\n    pointsHitTest(points, source) {\r\n        return points.some((point, index) => {\r\n            if (point.distance(source.x, source.y) <= this._circleDiameter) {\r\n                points.splice(index, 1);\r\n                return true;\r\n            }\r\n            else {\r\n                return false;\r\n            }\r\n        });\r\n    }\r\n}\r\n//# sourceMappingURL=Scratch.js.map",
  "references": [],
  "map": "{\"version\":3,\"file\":\"Scratch.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../src/extension/Scratch.ts\"],\"names\":[],\"mappings\":\"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\"}"
}
